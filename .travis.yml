language: android
jdk: oraclejdk7
env:
  matrix:
    - ANDROID_TARGET=android-23  ANDROID_ABI=armeabi-v7a
  global:
    - COVERALLS_REPO_TOKEN=gMnsR0XfIpFzW5H13OJGqbxns9L1rBnB1
sudo: false

# Android config
android:
  components:
    - platform-tools
    - build-tools-21.1.2
    - android-23
    - extra-android-support
  licenses:
    - '.+'

# Only send email on failure.
notifications:
  email:
    recipients:
      - wijnand@ledge.us
    on_success: never
    on_failure: always

# Emulator Management: Create, Start and Wait
before_script:
  - echo no | android create avd --force -n test -t android-23 --abi armeabi-v7a
  - emulator -avd test -no-audio -no-window &
  - android-wait-for-emulator
  - adb shell input keyevent 82 &

# Running tests.
script:
  - gradle -p sdk createDebugCoverageReport

after_success:
  # Send coverage info to Coveralls.io.
  - gradle -p sdk coveralls
